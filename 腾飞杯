摘  要 
   医学领域中大部分研究都需要收集大量数据，并依赖于对所收集数据的分析而展开。研究过程中的数据质量控制非常重要，决定了研究的质量和成败。越来越多的医学研究采用电子数据收集系统（Electronic Data Capture，EDC）收集研究数据，以保证数据质量和过程管理的规范。其中REDCap（Research Electronic Data Capture）系统数据录入方式多样，既可在已有纸质问卷的基础上，进行数据的电子化录入及质量控制，也可开放给调查对象直接在线填写一次问卷，再由研究人员对问卷进行审核。且该系统应用范围广，通过不同的功能模块设置可实现单次研究数据、长期纵向数据等多种类型数据的录入。 
    考虑到数据质量控制在医学研究中的重要性，本文将依托中国基层卫生保健质量队列研究（ACACIA）数据库建立过程中的实践经验，针对性地介绍在已有纸质问卷基础上，利用REDCap系统实现研究数据质量控制的方法，并通过SAS(Statistical Analysis System)数据分析软件设计数据质控工具，以手动编辑输入代码的方式，利用SAS代码实现对于数据库日常更新的半自动化数据质量控制。相比于人工操作，通过该数据质控工具既可减少用于检索日常更新数据的人工时间又能高效及时发现问题，弥补本应获得的数据的缺失，提高数据质量，使得该项目下的所有子课题都能获得较高质量的数据，并为数据库远期构想，为长远数据库开发获取提供质量保证，同时为医学研究的数据质量控制提供一定的借鉴作用。


关 键 词：数据质控；REDCAP系统；队列研究，SAS

目  录

第三十四届“腾飞杯”创新创业大赛创新赛道	1
参赛作品	1
1绪论	3
1.1研究背景	4
1.2研究内容与方法	4
2基础知识介绍	5
2.1 中国基层卫生保健质量队列研究（ACACIA）介绍	5
2.2 REDCAP系统介绍	7
2.3 SAS系统介绍	7
3.数据质控软件的开发	7
3.1数据质控的基本原理	7
3.2设计思路	8
4.系统开发与应用	9
4.1系统应用	9
5.质控结果与分析	14
5.1质控结果	14
5.2结果分析	16
6.总结	16
6.1结论	16
6.2创新之处	16
6.3不足之处	16
6.4展望	16


1绪论

1.1研究背景
以往，医学研究常采用纸质问卷收集数据，并应用EpiData软件进行数据双录入和质量控制。EpiData软件录入快捷、功能完备，是医学研究中广泛采用的数据管理和质量控制工具，但该软件为单机版程序，仅可进行单中心数据质量控制，没有联网核查功能，不适用于多中心研究对数据质量控制工作发展的要求。 当下CRF表的电子化是一种趋势, 即电子的病例报告表 (electronic Case Report Form, e CRF) [1], 在欧美等发达国家e CRF已完全取代了传统的纸质CRF[2]。而REDCap系统由范德堡大学的Paul Harris教授团队研发，具有易上手、便捷、安全、稳定等多种优点，近年来在国内外医学研究中得到广泛应用[3]。本文以SAS编程语言为例，基于REDCap系统开发大型自然人群队列数据质控工具，阐述数据质控软件开发的过程。
1.2研究内容与方法
1.2.1研究内容
本文选择中国基层卫生保健质量队列研究（ACACIA）数据库为对象，通过评价各医疗机构医疗质量、费用和患者体验的信息，为下一步研究提供质量保证。
1.2.2研究方法
本文以中国基层卫生保健质量队列研究（ACACIA）数据库为例，按照图1所示，通过REDCap系统进行电子化数据录入，在数据库录入新数据后，定时生成数据报表，以SAS9.4版本进行数据分析，对台词准确率及一致率进行可视化转换。

 
图 1 REDCap进行大型自然人群队列研究流程图


2基础知识介绍 

2.1 中国基层卫生保健质量队列研究（ACACIA）介绍
中国基层卫生保健质量队列研究协作组 (Primary heAIth Care quAlity Cohort In China, ACACIA Collaborative Group) 是以基层医疗服务质量评估与改善为核心任务的协作组。为了达到促进基层卫生保健服务质量的目标，协作组组建了基于标准化病人（Standardized Patient或SP）的基层卫生保健研究网络，并利用标准化病人的方法评估陆续开发一批匿名标准化病人（Unannounced SP / USP）病例，将最终形成USP病例库。匿名USP测量医疗质量的方法被称作医疗质量评估的金标准，尤其适用基层卫生服务质量的测量。它的基本做法是：招募健康人，通过严格的培训，让他们能够在不同的医疗机构之间恒定的扮演某些疾病的症状、体征和情绪特征，并按照正常的就诊程序到各基层医疗机构就诊，从而获得各医疗机构医疗质量、费用和患者体验的信息[4] 。
ACACIA研究自2017年4月启动至2020年8月1日期间，完成了所有标准化病人病例的开发、验证和相关调查表的准备。研究者于2020年8月23日8月29日期间在七省（四川、广东、内蒙古、甘肃、贵州、陕西和湖南）同时开展了线上+线下相结合的标准化病人扮演者和调查员的培训。随后，11种标准化病人病例的扮演者，即USP，于2020年 9月期间在七省会城市开展了为期1个月的现场调查。于2021年3月开始全国正式访问，截止到2022年11月4日，总共完成2128（96.7%）次访问，SP总体平均台词准确率为96%，USP填写质量考核清单结果和临床专家根据USP就诊录音填写的质量考核清单结果平均一致率90%，访问质量趋于稳定。
研究团队分别在七个省省会城市进行调查员和标准化患者的招募，研究中期由于新冠疫情爆发和SP个人原因，造成人员流失，因此开展了第二批SP的招募。截止到目前共有357位SP报名参加，77位SP接受培训，最终41位SP（其中30位SP扮演2种病例）分别扮演哮喘、心绞痛、压力性尿失禁、腰背痛、普通感冒、糖尿病、高血压、产后抑郁、胃炎和小儿腹泻患者监护人等11种标准化病人病例和其配对调查员参与到正式访问；
SP的培训采用线上和线下相结合的方式，包括三个阶段：
SP根据研究团队提供的病例教学视频完成自学，该视频包括八个部分：SP整体职责说明、个人利益和义务、就诊的一般流程、体格检查和实验室检查、以患者为中心量表（PPPC量表问卷）、药事服务表单及其他数据的采集； SP在线上测试中达到满分，即可与配对调查员进行一对一线上练习，并联系病例负责人进行测试，其中SP的台词准确率需要≥90%，调查员表单完成度要求为100%；以非匿名的方式与临床医生完成2次实际访问，并根据反馈进行加强学习；
经过三阶段的培训后SP和调查员将在基层医疗机构进行4-6次匿名访问进行验证，SP连续4次访问台词准确率≥90%或者6次访问平均台词准确率≥90%认定为合格，可作为质量评价工具到所抽样医疗机构进行现场访问。同时研究团队从内容效度、效标效度和表面效度三个方面评估USP作为质量评价工具的有效性。研究结果表明即使在新冠疫情背景下，USP的有效性仍然很高。

2.2 REDCAP系统介绍
REDCap是一个安全的网络平台，用于构建和管理在线数据库和调查。 REDCap简化的流程为快速创建和设计项目提供了大量工具，可以根据任何数据收集策略进行定制。提供自动化数据导出程序，可以无缝地把导出数据下载供EXCEL及常见统计软件(SPSS, SAS, Stata, R)使用。同时也提供了内置项目日历, 进度计划模块, 自由报表工具, 以及其它高级功能,例如：分支逻辑，文件上传和计算字段[5] 。

2.3 SAS系统介绍
SAS(Statistical  Analysis  System)系统由美国 SAS 软件研究所（SAS  Institute Inc.）于 1976 年推出。它是大型集成应用软件系统，具备了数据访问、数据管理、数据分析以及数据呈现功能。在数据管理和统计分析领域，SAS系统被认为是国际上标准软件系统。它是由众多产品组成的模块化的大型集成系统，其中 BASE SAS 模块是 SAS 系统的基础[6]。
3.数据质控软件的开发
3.1数据质控的基本原理
中国基层卫生保健质量队列研究（ACACIA）数据质控的主要目的是评价台词准确率、台词一致率与录音质量并统计异常数据，SP完成访问后，及时检查SP及调查员的表单填写情况，当天晚上核对病例负责人是否及时听录音并填写相关表单（台词准确率+诊疗清单），如有问题及时联系病例负责人检查原因并解决。总体数据调查及质控流程如图2。 
图2 ACACIA USP调查及质控流程图


3.2设计思路
要实现评价台词准确率、台词一致率与录音质量并统计异常数据的目的，质控软件的设计思路主要包括以下几方面：
（1）将所有原始数据统一保存，既便于SAS质控工具直接导入数据，又便于后续查找缺失值和错误值，精确定位，便于后续数据修正。
（2）分别设置台词准确率、台词一致率与录音质量的数据格式，将格式统一化，使原始数据转换为对应的数值变量，加快识别数据的速度并减少程序出错的概率。
（3）分数据类型，将人员访问安排、台词准确率、台词一致率和录音质量分别导入数据，并根据病例类型二次分类。
（4）计算每个台词准确率与一致率，合并平均台词准确率与一致率，输出分省份分病种表格——根据平均台词准确率计算是否合格,若小于90%则不合格根据全部台词准确率评价是否合格导入既往合格，根据要求设置判断标准。
（5）整理台词准确率、一致性与录音质量合并为一张excel报表。
（6）整理一致性评价原始数据形成第二张excel报表。

4.系统开发与应用

4.1系统应用
4.1.1导出数据
如图3通过REDcap系统导出原始数据，分别为分别对01访问安排、02台词准确率、04一致性进行数据导出，在“数据导出、报表及统计”模块中，可实现所有数据的查看和数据的导出。在“记录状态进度统计表”中只能看到单条记录的具体数据，而该模块中的“查看报表”功能，可将所有记录整合成为一个表单，快捷查看所有录入的记录。


 
图 3 “数据导出、报表及统计”界面

4.1.2数据质控
（1）依次打开编写的代码如图4，01 Format (update 20210331) 、02 (update 20210624) 01_basic、 03 (update 20210826) 02_accuracy 、04 (update 20210701) 03_consistency 、05 (update 20210527) 04_comprehensive 、06 (update 20210701) 05_report ，打开后界面如图5。 
图4使用SAS依次打开code1-6

 
图 5打开代码后SAS界面
 

（2）01 Format (update 20210331)的功能为指定数据存储路径，并为下一步的数据指定统一分析格式如图6；
 
图6界面 01 Format (update 20210331)
  

（3）将导出的数据文件ACACIA-01_DATA_NOHDRS_2022-11-04_2310.csv导入代码02、该步02 (update 20210624) 01_basic的功能为导入标签数据与人员访问安排并对数据按编号进行排序如图7；
 
图7  将原始数据导入代码02

（4）将导出的数据文件ACACIA-02_DATA_NOHDRS_2022-11-04_2310.csv导入代码03、该步03 (update 20210826) 02_accuracy的功能为导入计算台词准确率的数据，赋予标签加以排序，并将各组疾病分类分别构建新变量,计算台词准确率，最后纵向合并数据集如图8； 

 
图8将原始数据导入代码03


（5）将导出的数据文件ACACIA-04_DATA_NOHDRS_2022-11-04_2311.csv导入代码04、该步04 (update 20210701) 03_consistency的功能为导入一致性评价数据并赋予标签，根据病种保留特定数据展示数据录入情况，通过转置对一致与不一致进行对比，根据两次录音结果对数据进行调整，并对录音质量进行评价，得出一致性描述性统计结果如图9；  
图9将原始数据导入代码04

（6）05 (update 20210527) 04_comprehensive的功能为计算SP台词准确率与实际访问次数，调整成输出格式，计算全部台词、被动台词的平均准确率，根据平均被动台词与全部台词准确率计算是否合格并标注省份如图10,；

 
图10  界面05 (update 20210527) 04_comprehensive

（7）06 (update 20210701) 05_report的功能为将上述各数据赋予标签并汇总合并为Excel如图11；
 
图11 界面06 (update 20210701) 05_report




5.质控结果与分析
5.1质控结果
导入代码02、03、04，并依次运行代码01至06，结果如图12、图13，输出文件将自动保存在指定文件夹。

 
图 12 全国调查一致性准确率汇总报告表(20221104)-01

 
图13 全国调查一致性准确率汇总报告表(20221104)-02



5.2结果分析
由质控软件输出的excel包含主动台词准确率，被动台词准确率，一致性分病种、维度总体评价、录音质量、被动台词准确率综合汇报、全部台词准确率综合汇报 被动台词准确率综合汇报、全部台词准确率评价分省份、分病种合格频数与一致率原始数据，根据病种与地区分类，可通过数据报表完成数据访问与质控的目的。
6.总结
6.1结论
通过基于REDCAP系统开发大型自然人群队列质控工具，中国基层卫生保健质量队列研究（ACACIA）数据库的数据质量得到一定的保证
6.2创新之处
本文选择REDCAP系统
6.3不足之处

6.4展望















[1]曾宪涛,李宾,吕军,田国祥.全球临床研究的现状分析及趋势展望[J].中国循证心血管医学杂志,2017,9(12):1409-1414.
[2]InstaLLe AJ, van den Bosch T, De Moor B,et al. Clinical data miner:an electronic case report form system with integrated data preprocessing and machine-learning libraries supporting clinical diagnostic model research[J].JMIR Med Inform, 2014,2(2) :e28.
[3]耿辉,贺海蓉,曾宪涛,吕军.多中心临床数据采集系统REDCap系统应用及架设[J].中国循证心血管医学杂志,2017,9(09):1025-1028.
[4] Xu DR, Hu M, He W, et al.  Assessing the quality of primary healthcare in seven Chinese provinces with unannounced standardised patients: protocol of a cross-sectional survey. BMJ Open 2019;9:e023997. doi:10.1136/bmjopen-2018-023997
[5] Obe d JS, Mcgraw CA,Minor BlL t a.Procurement of shared data instruments for Research Electronic Data Capture(REDCap)[J Biomed lnform, 2013,46(2):259-65.
[6]刘一松. 基于PASS及SAS软件的常用样本含量估计方法实现及部分方法比较研究[D].中国人民解放军军事医学科学院,2016.
